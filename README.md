-- Q1: Add PRICE and DESCRIPTION columns to PRODUCTLIST
ALTER TABLE PRODUCTLIST
ADD (
    PRICE NUMBER(6,2),
    DESCRIPTION VARCHAR2(250)
);

UPDATE PRODUCTLIST p
SET PRICE = (
    SELECT s.PRICE
    FROM STOREFRONT s
    WHERE s.PRODUCTCODE = p.PRODUCTCODE
);

-- Q3: Move DESCRIPTION data from STOREFRONT to PRODUCTLIST
UPDATE PRODUCTLIST p
SET DESCRIPTION = (
    SELECT s.DESCRIPTION
    FROM STOREFRONT s
    WHERE s.PRODUCTCODE = p.PRODUCTCODE
);

SELECT PRODUCTCODE, PRICE, DESCRIPTION
FROM PRODUCTLIST;

DROP TABLE STOREFRONT;

-- Q5: Create CHATLOG table
CREATE TABLE CHATLOG (
    CHATID NUMBER(3),
    RECEIVERID NUMBER(3),
    SENDERID NUMBER(3),
    DATESENT DATE,
    CONTENT VARCHAR2(250),
    CONSTRAINT PK_CHATLOG PRIMARY KEY (CHATID),
    CONSTRAINT FK_CHAT_RECEIVER FOREIGN KEY (RECEIVERID) REFERENCES USERBASE(USERID),
    CONSTRAINT FK_CHAT_SENDER FOREIGN KEY (SENDERID) REFERENCES USERBASE(USERID)
);

-- Q6: Insert sample data into CHATLOG
INSERT INTO CHATLOG VALUES (1, 101, 102, SYSDATE-10, 'Hey, want to play later?');
INSERT INTO CHATLOG VALUES (2, 102, 101, SYSDATE-9, 'Sure!');
INSERT INTO CHATLOG VALUES (3, 103, 101, SYSDATE-8, 'Nice match!');
INSERT INTO CHATLOG VALUES (4, 104, 103, SYSDATE-7, 'Add me!');
INSERT INTO CHATLOG VALUES (5, 105, 101, SYSDATE-6, 'Hello!');
INSERT INTO CHATLOG VALUES (6, 101, 105, SYSDATE-5, 'Hey!');
INSERT INTO CHATLOG VALUES (7, 102, 104, SYSDATE-4, 'Good game');
INSERT INTO CHATLOG VALUES (8, 103, 105, SYSDATE-3, 'Thanks!');
INSERT INTO CHATLOG VALUES (9, 104, 102, SYSDATE-2, 'See you');
INSERT INTO CHATLOG VALUES (10,105, 103, SYSDATE-1, 'Bye');

SELECT * FROM CHATLOG;

-- Q7: Create FRIENDSLIST table
CREATE TABLE FRIENDSLIST (
    USERID NUMBER(3),
    FRIENDID NUMBER(3),
    CONSTRAINT PK_FRIENDSLIST PRIMARY KEY (USERID, FRIENDID),
    CONSTRAINT FK_FRIEND_USER FOREIGN KEY (USERID) REFERENCES USERBASE(USERID),
    CONSTRAINT FK_FRIEND_FRIEND FOREIGN KEY (FRIENDID) REFERENCES USERBASE(USERID)
);

-- Q8: Insert sample data into FRIENDSLIST
INSERT INTO FRIENDSLIST VALUES (101, 102);
INSERT INTO FRIENDSLIST VALUES (101, 103);
INSERT INTO FRIENDSLIST VALUES (102, 101);
INSERT INTO FRIENDSLIST VALUES (102, 104);
INSERT INTO FRIENDSLIST VALUES (103, 101);
INSERT INTO FRIENDSLIST VALUES (103, 105);
INSERT INTO FRIENDSLIST VALUES (104, 102);
INSERT INTO FRIENDSLIST VALUES (104, 105);
INSERT INTO FRIENDSLIST VALUES (105, 101);
INSERT INTO FRIENDSLIST VALUES (105, 103);

SELECT * FROM FRIENDSLIST;

-- Q9: Create WISHLIST table
CREATE TABLE WISHLIST (
    USERID NUMBER(3),
    PRODUCTCODE VARCHAR2(5),
    POSITION NUMBER(3),
    CONSTRAINT PK_WISHLIST PRIMARY KEY (USERID, PRODUCTCODE),
    CONSTRAINT FK_WISH_USER FOREIGN KEY (USERID) REFERENCES USERBASE(USERID),
    CONSTRAINT FK_WISH_PRODUCT FOREIGN KEY (PRODUCTCODE) REFERENCES PRODUCTLIST(PRODUCTCODE)
);

SELECT PRODUCTCODE
FROM PRODUCTLIST;

INSERT INTO WISHLIST VALUES (101, 'GAME1', 1);
INSERT INTO WISHLIST VALUES (101, 'GAME2', 2);

INSERT INTO WISHLIST VALUES (102, 'GAME3', 1);
INSERT INTO WISHLIST VALUES (102, 'GAME4', 2);

INSERT INTO WISHLIST VALUES (103, 'GAME5', 1);
INSERT INTO WISHLIST VALUES (103, 'GAME6', 2);

INSERT INTO WISHLIST VALUES (104, 'GAME7', 1);
INSERT INTO WISHLIST VALUES (104, 'GAME8', 2);

INSERT INTO WISHLIST VALUES (105, 'GAME9', 1);
INSERT INTO WISHLIST VALUES (105, 'GME12', 2);
